<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="åŸæ–‡ï¼šhttp://blogs.msdn.com/b/kaevans/archive/2011/04/11/intro-to-windbg-for-net-developers.aspx Â ç¿»è¯‘ï¼šcxfksword
å½“ä½ çš„ä»£ç å‘å¸ƒä¸ºäº§å“åï¼Œæ— è®ºæ˜¯åœ¨å…¶ä»–äººçš„ç”µè„‘ä¸­è¿è¡Œï¼Œè¿˜æ˜¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸­ï¼Œä½ é€šå¸¸ä¸å†èƒ½è®¿é—®åˆ°å®ƒçš„ç¨‹åºæ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è§‚å¯Ÿåˆ°ä»£ç çš„å½“å‰è¿è¡Œæƒ…å†µå’Œè¿è¡Œç¯å¢ƒã€‚å½“ä½ çš„ä»£ç åœ¨æ–°çš„ç¯å¢ƒè¿è¡Œæ—¶ï¼Œæœ‰å¾ˆå¤šå› ç´ ä¼šå½±å“åˆ°ç¨‹åºçš„è¿è¡Œæƒ…å†µï¼Œå¦‚æœåŠ¡å™¨ç³»ç»Ÿæ‰“äº†æ›´æ–°è¡¥ä¸ï¼Œç½‘ç»œç­–ç•¥æ”¹å˜ï¼Œé˜²ç«å¢™è§„åˆ™é™åˆ¶ï¼Œç£ç›˜æƒé™é…ç½®ç­‰ç­‰ã€‚å½“ä»£ç è¿è¡Œä¸æ­£å¸¸æ—¶ï¼Œä½ å¯èƒ½åªèƒ½é ä»£ç ä¸­å„å¤„è¾“å‡ºçš„æ—¥å¿—æ¥åˆ¤æ–­è¿è¡Œæƒ…å†µã€‚ä½†åªé è¾“å‡ºæ—¥å¿—ï¼Œä½ æœ‰æ—¶è¿˜æ˜¯ä¸èƒ½åˆ¤æ–­æ•…éšœå‡ºç°çš„åŸå› ã€‚
åœ¨ä¸æµªè´¹å®¢æˆ·æ—¶é—´çš„åŒæ—¶åšæ•…éšœæ’é™¤å¯¹ä½ æ˜¯ä¸ªå¾ˆå¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºä¸ä¼šæœ‰å®¢æˆ·å–œæ¬¢è¢«ä¸€ä¸ªææŠ€æœ¯çš„å®¶ä¼™ä¸æ–­é—®æ˜¯ç‚¹äº†é‚£ä¸ªæŒ‰é’®æ“ä½œäº†å“ªäº›æ­¥éª¤å¯¼è‡´ç¨‹åºå‡ºé”™çš„ã€‚bossä¹Ÿä¸ä¼šç»™ä½ å‡ å¤©ç”šè‡³å‡ å‘¨çš„æ—¶é—´è®©ä½ æ…¢æ…¢æ’é™¤æ•…éšœï¼Œä½ å¿…é¡»ç°åœ¨å°±çŸ¥é“åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚
ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°å †æ ˆè·Ÿè¸ªï¼Œèƒ½æŸ¥çœ‹åˆ°å½“å‰çš„å˜é‡å€¼ï¼Œèƒ½è°ƒè¯•ä»£ç ã€‚äº‹å®è¯æ˜ä½ å¯ä»¥åšåˆ°è¿™ç‚¹ã€‚ã€‚ã€‚è€Œä¸”ä¸éœ€è¦é™„åŠ åˆ°å®¢æˆ·ç¯å¢ƒä¸­ï¼"><base href=//blog.tri-lib.com/><title>é¢å‘.NETå¼€å‘äººå‘˜çš„WinDbgå…¥é—¨æ•™ç¨‹</title><link rel=canonical href=//blog.tri-lib.com/2012/02/intro-to-windbg-for-dotnet-developers/><link rel=stylesheet href=//blog.tri-lib.com/scss/style.min.css><meta property="og:title" content="é¢å‘.NETå¼€å‘äººå‘˜çš„WinDbgå…¥é—¨æ•™ç¨‹"><meta property="og:description" content="åŸæ–‡ï¼šhttp://blogs.msdn.com/b/kaevans/archive/2011/04/11/intro-to-windbg-for-net-developers.aspx Â ç¿»è¯‘ï¼šcxfksword
å½“ä½ çš„ä»£ç å‘å¸ƒä¸ºäº§å“åï¼Œæ— è®ºæ˜¯åœ¨å…¶ä»–äººçš„ç”µè„‘ä¸­è¿è¡Œï¼Œè¿˜æ˜¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸­ï¼Œä½ é€šå¸¸ä¸å†èƒ½è®¿é—®åˆ°å®ƒçš„ç¨‹åºæ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è§‚å¯Ÿåˆ°ä»£ç çš„å½“å‰è¿è¡Œæƒ…å†µå’Œè¿è¡Œç¯å¢ƒã€‚å½“ä½ çš„ä»£ç åœ¨æ–°çš„ç¯å¢ƒè¿è¡Œæ—¶ï¼Œæœ‰å¾ˆå¤šå› ç´ ä¼šå½±å“åˆ°ç¨‹åºçš„è¿è¡Œæƒ…å†µï¼Œå¦‚æœåŠ¡å™¨ç³»ç»Ÿæ‰“äº†æ›´æ–°è¡¥ä¸ï¼Œç½‘ç»œç­–ç•¥æ”¹å˜ï¼Œé˜²ç«å¢™è§„åˆ™é™åˆ¶ï¼Œç£ç›˜æƒé™é…ç½®ç­‰ç­‰ã€‚å½“ä»£ç è¿è¡Œä¸æ­£å¸¸æ—¶ï¼Œä½ å¯èƒ½åªèƒ½é ä»£ç ä¸­å„å¤„è¾“å‡ºçš„æ—¥å¿—æ¥åˆ¤æ–­è¿è¡Œæƒ…å†µã€‚ä½†åªé è¾“å‡ºæ—¥å¿—ï¼Œä½ æœ‰æ—¶è¿˜æ˜¯ä¸èƒ½åˆ¤æ–­æ•…éšœå‡ºç°çš„åŸå› ã€‚
åœ¨ä¸æµªè´¹å®¢æˆ·æ—¶é—´çš„åŒæ—¶åšæ•…éšœæ’é™¤å¯¹ä½ æ˜¯ä¸ªå¾ˆå¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºä¸ä¼šæœ‰å®¢æˆ·å–œæ¬¢è¢«ä¸€ä¸ªææŠ€æœ¯çš„å®¶ä¼™ä¸æ–­é—®æ˜¯ç‚¹äº†é‚£ä¸ªæŒ‰é’®æ“ä½œäº†å“ªäº›æ­¥éª¤å¯¼è‡´ç¨‹åºå‡ºé”™çš„ã€‚bossä¹Ÿä¸ä¼šç»™ä½ å‡ å¤©ç”šè‡³å‡ å‘¨çš„æ—¶é—´è®©ä½ æ…¢æ…¢æ’é™¤æ•…éšœï¼Œä½ å¿…é¡»ç°åœ¨å°±çŸ¥é“åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚
ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°å †æ ˆè·Ÿè¸ªï¼Œèƒ½æŸ¥çœ‹åˆ°å½“å‰çš„å˜é‡å€¼ï¼Œèƒ½è°ƒè¯•ä»£ç ã€‚äº‹å®è¯æ˜ä½ å¯ä»¥åšåˆ°è¿™ç‚¹ã€‚ã€‚ã€‚è€Œä¸”ä¸éœ€è¦é™„åŠ åˆ°å®¢æˆ·ç¯å¢ƒä¸­ï¼"><meta property="og:url" content="//blog.tri-lib.com/2012/02/intro-to-windbg-for-dotnet-developers/"><meta property="og:site_name" content="cxfksword's notes"><meta property="og:type" content="article"><meta name=twitter:title content="é¢å‘.NETå¼€å‘äººå‘˜çš„WinDbgå…¥é—¨æ•™ç¨‹"><meta name=twitter:description content="åŸæ–‡ï¼šhttp://blogs.msdn.com/b/kaevans/archive/2011/04/11/intro-to-windbg-for-net-developers.aspx Â ç¿»è¯‘ï¼šcxfksword
å½“ä½ çš„ä»£ç å‘å¸ƒä¸ºäº§å“åï¼Œæ— è®ºæ˜¯åœ¨å…¶ä»–äººçš„ç”µè„‘ä¸­è¿è¡Œï¼Œè¿˜æ˜¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸­ï¼Œä½ é€šå¸¸ä¸å†èƒ½è®¿é—®åˆ°å®ƒçš„ç¨‹åºæ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è§‚å¯Ÿåˆ°ä»£ç çš„å½“å‰è¿è¡Œæƒ…å†µå’Œè¿è¡Œç¯å¢ƒã€‚å½“ä½ çš„ä»£ç åœ¨æ–°çš„ç¯å¢ƒè¿è¡Œæ—¶ï¼Œæœ‰å¾ˆå¤šå› ç´ ä¼šå½±å“åˆ°ç¨‹åºçš„è¿è¡Œæƒ…å†µï¼Œå¦‚æœåŠ¡å™¨ç³»ç»Ÿæ‰“äº†æ›´æ–°è¡¥ä¸ï¼Œç½‘ç»œç­–ç•¥æ”¹å˜ï¼Œé˜²ç«å¢™è§„åˆ™é™åˆ¶ï¼Œç£ç›˜æƒé™é…ç½®ç­‰ç­‰ã€‚å½“ä»£ç è¿è¡Œä¸æ­£å¸¸æ—¶ï¼Œä½ å¯èƒ½åªèƒ½é ä»£ç ä¸­å„å¤„è¾“å‡ºçš„æ—¥å¿—æ¥åˆ¤æ–­è¿è¡Œæƒ…å†µã€‚ä½†åªé è¾“å‡ºæ—¥å¿—ï¼Œä½ æœ‰æ—¶è¿˜æ˜¯ä¸èƒ½åˆ¤æ–­æ•…éšœå‡ºç°çš„åŸå› ã€‚
åœ¨ä¸æµªè´¹å®¢æˆ·æ—¶é—´çš„åŒæ—¶åšæ•…éšœæ’é™¤å¯¹ä½ æ˜¯ä¸ªå¾ˆå¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºä¸ä¼šæœ‰å®¢æˆ·å–œæ¬¢è¢«ä¸€ä¸ªææŠ€æœ¯çš„å®¶ä¼™ä¸æ–­é—®æ˜¯ç‚¹äº†é‚£ä¸ªæŒ‰é’®æ“ä½œäº†å“ªäº›æ­¥éª¤å¯¼è‡´ç¨‹åºå‡ºé”™çš„ã€‚bossä¹Ÿä¸ä¼šç»™ä½ å‡ å¤©ç”šè‡³å‡ å‘¨çš„æ—¶é—´è®©ä½ æ…¢æ…¢æ’é™¤æ•…éšœï¼Œä½ å¿…é¡»ç°åœ¨å°±çŸ¥é“åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚
ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°å †æ ˆè·Ÿè¸ªï¼Œèƒ½æŸ¥çœ‹åˆ°å½“å‰çš„å˜é‡å€¼ï¼Œèƒ½è°ƒè¯•ä»£ç ã€‚äº‹å®è¯æ˜ä½ å¯ä»¥åšåˆ°è¿™ç‚¹ã€‚ã€‚ã€‚è€Œä¸”ä¸éœ€è¦é™„åŠ åˆ°å®¢æˆ·ç¯å¢ƒä¸­ï¼"><meta property="article:section" content="Post"><meta property="article:tag" content="WinDbg"><meta property="article:published_time" content="2012-02-01T08:28:43+00:00"><meta property="article:modified_time" content="2012-02-01T08:28:43+00:00"><link rel=icon type=image/png href=//blog.tri-lib.com/img/favicon_hucaec59626a4b072e0484c02c0d7451cf_2387_32x0_resize_box_2.png><style>.article-page article .article-content img{max-width:720px}</style></head><body><div id=content><div class="container extended flex on-phone--column align-items--flex-start article-page with-toolbar"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header class=site-info><figure class=site-avatar><img src=//blog.tri-lib.com/img/avatar_hub76bbbc8c06c72418eefeedfe902e916_30687_300x300_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
<span class=emoji>ğŸ¥</span></figure><h1 class=site-name><a href=//blog.tri-lib.com/>cxfksword's notes</a></h1><h2 class=site-description>simple thinking, simple life.</h2></header><nav class=menu id=main-menu><li><a href=//blog.tri-lib.com/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>é¦–é¡µ</span></a></li><li><a href=//blog.tri-lib.com/archive/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>å½’æ¡£</span></a></li><li><a href=//blog.tri-lib.com/projects><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg><span>é¡¹ç›®</span></a></li><li><a href=//blog.tri-lib.com/abouts><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>å…³äº</span></a></li><li><a href=//blog.tri-lib.com/index.xml><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg><span>è®¢é˜…</span></a></li></nav></aside><div class="flex column do-not-overflow full-width"><main class=main><div id=article-toolbar><a href=//blog.tri-lib.com/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>Back</span></a></div><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=//blog.tri-lib.com/categories/%E6%8A%80%E6%9C%AF>æŠ€æœ¯</a></header><h2 class=article-title><a href=//blog.tri-lib.com/2012/02/intro-to-windbg-for-dotnet-developers/>é¢å‘.NETå¼€å‘äººå‘˜çš„WinDbgå…¥é—¨æ•™ç¨‹</a></h2><footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--published>Feb 01, 2012</time></footer></div></header><section class=article-content><p>åŸæ–‡ï¼š<a class=link href=http://blogs.msdn.com/b/kaevans/archive/2011/04/11/intro-to-windbg-for-net-developers.aspx target=_blank rel=noopener>http://blogs.msdn.com/b/kaevans/archive/2011/04/11/intro-to-windbg-for-net-developers.aspx
</a>Â ç¿»è¯‘ï¼šcxfksword</p><p>å½“ä½ çš„ä»£ç å‘å¸ƒä¸ºäº§å“åï¼Œæ— è®ºæ˜¯åœ¨å…¶ä»–äººçš„ç”µè„‘ä¸­è¿è¡Œï¼Œè¿˜æ˜¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸­ï¼Œä½ é€šå¸¸ä¸å†èƒ½è®¿é—®åˆ°å®ƒçš„ç¨‹åºæ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è§‚å¯Ÿåˆ°ä»£ç çš„å½“å‰è¿è¡Œæƒ…å†µå’Œè¿è¡Œç¯å¢ƒã€‚å½“ä½ çš„ä»£ç åœ¨æ–°çš„ç¯å¢ƒè¿è¡Œæ—¶ï¼Œæœ‰å¾ˆå¤šå› ç´ ä¼šå½±å“åˆ°ç¨‹åºçš„è¿è¡Œæƒ…å†µï¼Œå¦‚æœåŠ¡å™¨ç³»ç»Ÿæ‰“äº†æ›´æ–°è¡¥ä¸ï¼Œç½‘ç»œç­–ç•¥æ”¹å˜ï¼Œé˜²ç«å¢™è§„åˆ™é™åˆ¶ï¼Œç£ç›˜æƒé™é…ç½®ç­‰ç­‰ã€‚å½“ä»£ç è¿è¡Œä¸æ­£å¸¸æ—¶ï¼Œä½ å¯èƒ½åªèƒ½é ä»£ç ä¸­å„å¤„è¾“å‡ºçš„æ—¥å¿—æ¥åˆ¤æ–­è¿è¡Œæƒ…å†µã€‚ä½†åªé è¾“å‡ºæ—¥å¿—ï¼Œä½ æœ‰æ—¶è¿˜æ˜¯ä¸èƒ½åˆ¤æ–­æ•…éšœå‡ºç°çš„åŸå› ã€‚</p><p>åœ¨ä¸æµªè´¹å®¢æˆ·æ—¶é—´çš„åŒæ—¶åšæ•…éšœæ’é™¤å¯¹ä½ æ˜¯ä¸ªå¾ˆå¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºä¸ä¼šæœ‰å®¢æˆ·å–œæ¬¢è¢«ä¸€ä¸ªææŠ€æœ¯çš„å®¶ä¼™ä¸æ–­é—®æ˜¯ç‚¹äº†é‚£ä¸ªæŒ‰é’®æ“ä½œäº†å“ªäº›æ­¥éª¤å¯¼è‡´ç¨‹åºå‡ºé”™çš„ã€‚bossä¹Ÿä¸ä¼šç»™ä½ å‡ å¤©ç”šè‡³å‡ å‘¨çš„æ—¶é—´è®©ä½ æ…¢æ…¢æ’é™¤æ•…éšœï¼Œä½ å¿…é¡»ç°åœ¨å°±çŸ¥é“åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°å †æ ˆè·Ÿè¸ªï¼Œèƒ½æŸ¥çœ‹åˆ°å½“å‰çš„å˜é‡å€¼ï¼Œèƒ½è°ƒè¯•ä»£ç ã€‚äº‹å®è¯æ˜ä½ å¯ä»¥åšåˆ°è¿™ç‚¹ã€‚ã€‚ã€‚è€Œä¸”ä¸éœ€è¦é™„åŠ åˆ°å®¢æˆ·ç¯å¢ƒä¸­ï¼</p><p><strong>ä¸‹è½½WinDbg</strong>
<a class=link href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=8279" target=_blank rel=noopener>ä¸‹è½½Debugging Tools for Windows</a>åˆ°ä½ çš„æœ¬åœ°å¼€å‘æœºä¸­ï¼Œwindbgæ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœä½ åªéœ€è¦windbgï¼Œåœ¨å¯ä»¥åœ¨â€œ<em>Common Utilities</em>â€ä¸­é€‰æ‹©â€œ<em>Debugging Tools for Windows</em>&ldquo;è¿›å…¥å®‰è£…ã€‚å®‰è£…ç¨‹åºä¼šæ ¹æ®ä½ ç”µè„‘çš„cpuç±»å‹å®‰è£…å¯¹åº”çš„windbgï¼Œx86çš„ç”µè„‘ä¼šå®‰è£…x86ç‰ˆæœ¬ï¼Œx64çš„cpuç”µè„‘å°±ä¼šå®‰è£…x64ç‰ˆã€‚å¦‚æœä½ é€‰æ‹©çš„æ˜¯â€œ<em>Redistributable Packages</em>â€œï¼Œå°±ä¼šä¸ºä½ ä¸‹è½½å…¨éƒ¨ä¸‰ä¸ªç‰ˆæœ¬ï¼ˆx86,x64,Itaniumï¼‰ã€‚</p><p><img src=http://ww3.sinaimg.cn/large/7ce4a9f6gw1e5q1emjvn9j20l00el41h.jpg alt="windbg tutorial"></p><p>WinDbgé»˜è®¤ä¼šå®‰è£…åˆ°cç›˜çš„â€œProgram Files\Debugging Tools for Windowsâ€æ–‡ä»¶å¤¹ä¸‹ï¼Œå»ºè®®ä½ æŠŠå®‰è£…ç›®å½•å¤åˆ¶åˆ°â€œd:\debugâ€ï¼Œè¿™æ ·æ–¹ä¾¿åé¢å¢åŠ å…¶ä»–æ‰©å±•ç»„ä»¶ã€‚</p><p>å®‰è£…å¥½åï¼Œç›®å½•ä¸‹çš„windbg.exeå°±æ˜¯windbgç¨‹åº</p><p><strong>å®‰è£…PssCor2</strong></p><p>****ä¸‹ä¸€æ­¥æ˜¯åŠ è½½æ‰˜ç®¡ä»£ç æ‰©å±•ç»„ä»¶PssCor2ã€‚é»˜è®¤æ—¶ï¼ŒWinDbgåªèƒ½ç”¨äºè°ƒè¯•éæ‰˜ç®¡ä»£ç ç¨‹åº ï¼Œè€ŒåŠ è½½.netä½¿ç”¨çš„SOS.dllæ‰©å±•ç»„ä»¶åï¼ŒWinDbgå°±èƒ½è°ƒè¯•æ‰˜ç®¡ç¨‹åºäº†ã€‚WinDbgè°ƒè¯•.netç¨‹åºçš„å¦ä¸€ä¸ªé€‰æ‹©æ˜¯PssCor2ï¼Œå®ƒæ˜¯SOS.dllçš„è¶…é›†ï¼Œå¹¶æä¾›äº†ä¸€äº›é¢å¯¹æ‰˜ç®¡ä»£ç çš„é¢å¤–åŠŸèƒ½ï¼Œå¦‚æŸ¥çœ‹æ‰˜ç®¡çº¿ç¨‹ï¼Œæ‰˜ç®¡å †ï¼ŒCLRå †æ ˆç­‰ç­‰ã€‚</p><p><a class=link href="http://www.microsoft.com/download/en/details.aspx?id=1073" target=_blank rel=noopener>ä¸‹è½½PssCor2</a>å¹¶è§£å‹åˆ°â€œd:\debugâ€ï¼Œä»¥æ–¹ä¾¿åé¢çš„è°ƒè¯•ä½¿ç”¨ã€‚</p><p><img src=http://ww3.sinaimg.cn/large/7ce4a9f6gw1e5q1fetlpgj20k9096q42.jpg alt="windbg tutorial"></p><p><strong>è®¾å®šç¬¦å·æ–‡ä»¶è·¯å¾„ï¼ˆSymbol Pathï¼‰</strong></p><p>****å½“ä½ ä½¿ç”¨Visual Studioç¼–è¯‘ç¨‹åºæ—¶ï¼Œæ˜¯å¦æœ‰ç•™æ„åˆ°åœ¨bin/Debugæ–‡ä»¶å¤¹ä¸‹ä¼šæœ‰.pdbåç¼€çš„æ–‡ä»¶ï¼Ÿè¿™äº›æ–‡ä»¶åŒ…å«æœ‰dllç¨‹åºé›†çš„è°ƒè¯•ç¬¦å·ï¼Œpdbæ–‡ä»¶å¹¶ä¸åŒ…å«æœ‰æ‰§è¡Œä»£ç ï¼Œåªæ˜¯ä½¿è°ƒè¯•å·¥å…·èƒ½æŠŠä»£ç æ‰§è¡ŒæŒ‡ä»¤ç¿»è¯‘ä¸ºæ­£ç¡®çš„å¯è¯†åˆ«å­—ç¬¦ã€‚å¾®è½¯æä¾›äº†åŒ…å«å¤§é‡pdbæ–‡ä»¶çš„å…¬å…±æœåŠ¡å™¨ï¼Œåœ°å€å¦‚ä¸‹ï¼š</p><p><a href=http://msdl.microsoft.com/download/symbols>http://msdl.microsoft.com/download/symbols</a></p><p>åœ¨windbgä¸­è®¾å®šç¬¦å·æ–‡ä»¶è·¯å¾„åï¼Œç›¸å…³çš„pdbæ–‡ä»¶ä¼šè‡ªåŠ¨ä»æœåŠ¡å™¨ä¸‹è½½ä¸‹æ¥å¹¶ä¿å­˜åˆ°æœ¬åœ°ã€‚ä½ é¦–å…ˆéœ€è¦æŒ‡å®šä¸€ä¸ªpdbæ–‡ä»¶çš„ä¿å­˜è·¯å¾„ï¼Œå¦‚â€œd:\debug\symbolsâ€ã€‚</p><p><img src=http://ww4.sinaimg.cn/large/7ce4a9f6gw1e5q1g54ge9j20h207zta1.jpg alt="windbg tutorial">
æ‰“å¼€windbgç¨‹åºï¼Œé€‰æ‹©â€œFile->Symbol File Pathâ€¦â€œï¼ŒæŠŠä¸‹é¢çš„å†…å®¹å¤åˆ¶è¿›å»ä¿å­˜ã€‚</p><pre><code>srv*d:\debug\symbols*http://msdl.microsoft.com/download/symbols
</code></pre><p><img src=http://ww3.sinaimg.cn/large/7ce4a9f6gw1e5q1gqvwzcj20fv05tdg6.jpg alt="windbg tutorial"></p><p><strong>åˆ›å»ºæµ‹è¯•ç¨‹åº</strong></p><p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œç¨‹åºç”¨äºæµ‹è¯•ï¼š</p><pre><code>using System;

namespace Microsoft.PFE.Samples
{
    public class Program
    {
        static void Main()
        {
            Console.WriteLine(&quot;Enter a message:&quot;);
        string input = Console.ReadLine();
            Data d = new Data
            {
                ID = 5,
                Message = input,
                CurrentDateTime = System.DateTime.Now
            };
            Console.WriteLine(&quot;You entered: &quot; + d);
        }
    }

    public class Data
    {
        public int ID {get; set;}
        public string Message {get; set;}
        public DateTime CurrentDateTime {get; set;}

        public override string ToString()
        {
            Console.ReadLine();
            return string.Format(&quot;ID:{0} {1} at {2}&quot;, ID, Message,

CurrentDateTime.ToLongTimeString());
        }
    }
}
</code></pre><p>å› ä¸ºPssCor2åªèƒ½å¤„ç†.Net 3.5ä»¥ä¸‹çš„ç¨‹åºï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘å‰éœ€è¦å…ˆæŠŠç¨‹åºçš„ç¯å¢ƒæ”¹ä¸º.Net 3.5ã€‚å‡å¦‚æ˜¯è°ƒè¯•.NET 4.0çš„ç¨‹åºï¼Œå¯ä»¥<a class=link href="http://www.microsoft.com/download/en/details.aspx?id=21255" target=_blank rel=noopener>ä¸‹è½½PssCor4</a>ã€‚ç¼–è¯‘è¿è¡Œç¨‹åºï¼Œè¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œçœ‹ç¨‹åºæ˜¯å¦è¿è¡Œæ­£å¸¸ã€‚</p><p>å®¢æˆ·æŠ±æ€¨è¯´ä¸çŸ¥é“ä¸ºä»€ä¹ˆç¨‹åºéœ€è¦æŒ‰ä¸¤æ¬¡enteré”®ã€‚ç¨‹åºå¹¶ä¸æŒ‰æˆ‘ä»¬çš„é¢„æœŸå·¥ä½œï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°å…·ä½“çš„åŸå› ã€‚ä½œä¸ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬èƒ½ä¸€çœ¼çœ‹å‡ºä»£ç ä¸­çš„ToString()æ–¹æ³•ä¸­å¤šäº†ä¸€æ¬¡ReadLine()å¯¼è‡´çš„ï¼Œä½†æˆ‘ä»¬è¿™æ¬¡è¯•ä¸‹ç”¨windbgæ‰¾å‡ºé—®é¢˜æ‰€åœ¨ã€‚</p><p>è¿è¡Œç¨‹åºï¼Œè¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‰ä¸€æ¬¡enterï¼Œå½“å‡ºç°ç¬¬äºŒæ¬¡è¾“å…¥æç¤ºæ—¶ï¼Œä¸è¦åŠ¨ï¼æˆ‘ä»¬å¤„äºæ•æ‰é—®é¢˜çš„å…³é”®ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€ä¸ªdumpæ–‡ä»¶ã€‚</p><p><strong>åˆ›å»ºdumpæ–‡ä»¶</strong></p><p>****åœ¨windows7å’Œwindows2008ä¸­ï¼Œå¯ä»¥åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­ç›´æ¥åˆ›å»ºdumpæ–‡ä»¶ã€‚åªéœ€æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œå³é”®è¿›ç¨‹åå¹¶é€‰æ‹©â€œCreate Dump Fileâ€ã€‚</p><p><img src=http://ww1.sinaimg.cn/large/7ce4a9f6gw1e5q1h819trj20sg0cbn0n.jpg alt="windbg tutorial"></p><p>dumpæ–‡ä»¶åˆ›å»ºæˆåŠŸåï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°æç¤ºï¼š</p><p><img src=http://ww1.sinaimg.cn/large/7ce4a9f6gw1e5q1ihkg7aj20sg0ca42h.jpg alt="windbg tutorial"></p><p>dumpæ–‡ä»¶æ˜¯å½“å‰è¿›ç¨‹çš„å†…å­˜å¿«ç…§ï¼Œdumpæ–‡ä»¶çš„å¤§å°ä¼šå’Œè¿›ç¨‹ä½¿ç”¨çš„å†…å­˜å¤§å°ä¸€æ ·ï¼Œä¸ºäº†å‡å°‘ä½“ç§¯ï¼Œä½ å¯ä»¥ä½¿ç”¨å‹ç¼©è½¯ä»¶è¿›è¡Œå‹ç¼©ã€‚</p><p>è¿˜æœ‰å¦å¤–çš„å·¥å…·å¯ä»¥åˆ›å»ºdumpæ–‡ä»¶ï¼Œå¦‚<a class=link href=http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx target=_blank rel=noopener>Process Explorer from SysInternals</a>ï¼Œä¹Ÿåªéœ€è¦åœ¨ä»»åŠ¡ç®¡ç†ä¸­å³é”®é€‰æ‹©â€œFull Dumpâ€ã€‚</p><p><img src=http://ww2.sinaimg.cn/large/7ce4a9f6gw1e5q1j0grajj20fq0anwgj.jpg alt="windbg tutorial"></p><p>ADPluså’ŒDebugDiagä¹Ÿå¯ä»¥åˆ›å»ºdumpæ–‡ä»¶ã€‚ADPlusæ˜¯windbgå®‰è£…ç›®å½•ä¸‹çš„ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºï¼Œä½ å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªdumpæ–‡ä»¶ï¼š</p><pre><code>Adplus -quiet -hang -p 4332 -o d:\debug
</code></pre><p>4332æ˜¯è¿›ç¨‹idï¼Œä»»åŠ¡ç®¡ç†å™¨é»˜è®¤æ˜¯ä¸æ˜¾ç¤ºè¿›ç¨‹idçš„ï¼Œè¦æ˜¾ç¤ºå‡ºæ¥ï¼Œéœ€è¦åœ¨windowsä»»åŠ¡ç®¡ç†å™¨é€‰æ‹©â€œæŸ¥çœ‹->é€‰æ‹©åˆ—â€ï¼Œå‹¾é€‰â€œPIDï¼ˆè¿›ç¨‹æ ‡è¯†ç¬¦ï¼‰â€ã€‚</p><p><strong>å¼€å§‹ä½¿ç”¨WinDbg</strong></p><p>****ç°åœ¨æˆ‘ä»¬æœ‰äº†ç¨‹åºdumpæ–‡ä»¶ï¼Œæ‰“å¼€windbgç¨‹åºï¼Œé€‰æ‹©èœå•â€œFile->Open Crash Dumpâ€ï¼Œå¹¶é€‰æ‹©åˆšåˆ›å»ºçš„dumpæ–‡ä»¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€äº›ä¿¡æ¯ï¼š</p><pre><code>Loading Dump File [D:\debug\program6.dmp]
User Mini Dump File: Only registers, stack and portions of memory are available

Symbol search path is: srv*d:\debug\symbols*http://msdl.microsoft.com/download/symbols
Executable search path is:
Windows 7 Version 7600 MP (8 procs) Free x64
Product: WinNt, suite: SingleUserTS
Machine Name:
Debug session time: Sun Feb  6 10:43:57.000 2011 (GMT-6)
System Uptime: not available
Process Uptime: 0 days 1:05:48.000
.........................
ntdll!NtRequestWaitReplyPort+0xa:
00000000`76d2ff7a c3              ret
</code></pre><p>åœ¨ä¸Šé¢çš„æ–‡å­—ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°dumpæ–‡ä»¶çš„è·¯å¾„ï¼Œç¬¦å·æ–‡ä»¶çš„æŸ¥æ‰¾è·¯å¾„ç­‰ä¿¡æ¯ã€‚è€Œç¨‹åºæœ€ä¸‹æ–¹æœ‰ä¸ªè¾“å…¥æ¡†ï¼Œä½ å¯ä»¥åœ¨ä¸Šé¢è¾“å…¥å‘½ä»¤ã€‚</p><p><img src=http://ww1.sinaimg.cn/large/7ce4a9f6gw1e5q1jkayjcj20sg0dtjul.jpg alt="windbg tutorial"></p><p><strong>æ˜¾ç¤ºæ¨¡å—</strong></p><p>è®©æˆ‘ä»¬è¯•ä¸‹æ˜¾ç¤ºç¨‹åºå·²åŠ è½½äº†å“ªäº›æ¨¡å—ã€‚åœ¨çª—å£æœ€ä¸‹æ–¹çš„è¾“å…¥æ¡†ä¸­ï¼Œè¾“å…¥â€œlmâ€å‘½ä»¤ã€‚</p><pre><code>0:000&gt; lm
start             end                 module name
00000000`00120000 00000000`00128000   program    (deferred)
00000000`742b0000 00000000`74379000   msvcr80    (deferred)
00000000`76ac0000 00000000`76bba000   user32     (deferred)
00000000`76bc0000 00000000`76cdf000   kernel32   (pdb symbols)          d:\debug\symbols\kernel32.pdb\D5E268B5DD1048A1BFB011C744DD3DFA2\kernel32.pdb
00000000`76ce0000 00000000`76e8b000   ntdll      (pdb symbols)          d:\debug\symbols\ntdll.pdb\0F7FCF88442F4B0E9FB51DC4A754D9DE2\ntdll.pdb
000007fe`f3fb0000 000007fe`f4134000   mscorjit   (deferred)
000007fe`f5030000 000007fe`f5f0b000   mscorlib_ni   (deferred)
000007fe`f7650000 000007fe`f7ffe000   mscorwks   (deferred)
000007fe`f8010000 000007fe`f80a0000   mscoreei   (deferred)
000007fe`f80a0000 000007fe`f810f000   mscoree    (deferred)
000007fe`fcb70000 000007fe`fcb7f000   CRYPTBASE   (deferred)
000007fe`fcc40000 000007fe`fcc4f000   profapi    (deferred)
000007fe`fcf20000 000007fe`fcf8b000   KERNELBASE   (deferred)
000007fe`fd0e0000 000007fe`fd2e2000   ole32      (deferred)
000007fe`fd4d0000 000007fe`fd59a000   usp10      (deferred)
000007fe`fd6f0000 000007fe`fe476000   shell32    (deferred)
000007fe`fe480000 000007fe`fe4ae000   imm32      (deferred)
000007fe`fe840000 000007fe`fe84e000   lpk        (deferred)
000007fe`fe9d0000 000007fe`feaab000   advapi32   (deferred)
000007fe`feb50000 000007fe`fec7e000   rpcrt4     (deferred)
000007fe`fec80000 000007fe`fecf1000   shlwapi    (deferred)
000007fe`fed00000 000007fe`fed67000   gdi32      (deferred)
000007fe`fee10000 000007fe`fef19000   msctf      (deferred)
000007fe`fef20000 000007fe`fefbf000   msvcrt     (deferred)
000007fe`fefd0000 000007fe`fefef000   sechost    (deferred)
</code></pre><p>åœ¨ä¸Šé¢çš„æ¨¡å—åˆ—è¡¨ä¸­ï¼Œä½ éœ€è¦å…³æ³¨çš„æ˜¯mscorwksæ˜¯å¦å­˜åœ¨ï¼ŒPssCor2åªèƒ½ç”¨äº.NET 3.5çš„ç¨‹åºï¼Œå‡å¦‚æ˜¯.NET 4.0ç¨‹åºï¼Œå°±çœ‹ä¸åˆ°mscorwksæ¨¡å—ã€‚</p><p>å¯¹äºSharePointå¼€å‘äººå‘˜ï¼Œå‡å¦‚ä½ æ­£åœ¨è°ƒè¯•ç¨‹åºç‰¹æ€§å¦‚ receivers å’Œ event å¤„ç†ä¸ºä»€ä¹ˆä¸è§¦å‘ï¼Œlmå°†æ˜¯å¾ˆå¥½ç”¨çš„å‘½ä»¤ã€‚é€šè¿‡ä¸Šé¢çš„åˆ—è¡¨ï¼Œä½ èƒ½çŸ¥é“æœ‰å“ªäº›æ¨¡å—æ²¡åŠ è½½è¿›æ¥ï¼Œå¯èƒ½æ˜¯é…ç½®ä¸æ­£ç¡®å¯¼è‡´çš„ï¼Œè¿™æ ·èƒ½å¤§å¤§åœ°å‡å°‘ä½ æŸ¥æ‰¾é—®é¢˜çš„èŒƒå›´ã€‚å¯¹äºASP.NETå¼€å‘äººå‘˜ï¼Œä¼šæœ‰åŠ©äºæŸ¥æ‰¾HttpModuleä¸è§¦å‘çš„åŸå› ï¼Œå¯èƒ½æ˜¯web.configé…ç½®ä¸æ­£ç¡®ã€‚</p><p><strong>åŠ è½½PssCor2</strong></p><p>è¦æŠŠPssCor2æ‰©å±•ç»„ä»¶åŠ è½½å…¥windbgï¼Œéœ€ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p><pre><code>.load d:\debug\psscor2\amd64\psscor2.dll
</code></pre><p>æˆ‘çš„ç”µè„‘æ˜¯64ä½çš„ï¼Œæ‰€ä»¥æˆ‘åŠ è½½äº†AMD64 ç‰ˆæœ¬çš„PssCor2.dllã€‚åŠ è½½çš„PssCor2ç‰ˆæœ¬å¿…é¡»å’Œdumpæ–‡ä»¶è¿›ç¨‹æ‰€åœ¨æœåŠ¡å™¨çš„æ¶æ„ç›¸ä¸€è‡´ï¼Œå‡å¦‚ä½ æ˜¯è°ƒè¯•x86ç¨‹åºçš„dumpæ–‡ä»¶ï¼Œä½ å°±å¿…é¡»åŠ è½½x86ç‰ˆæœ¬çš„PssCor2.dllã€‚
è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œä»¥ç¡®è®¤PssCor2æ˜¯å¦åŠ è½½æˆåŠŸï¼š</p><pre><code>!help
</code></pre><p>æ­£ç¡®ä¼šè¾“å…¥ä¸‹é¢çš„å†…å®¹ï¼š</p><pre><code>0:000&gt; .load d:\debug\psscor2\amd64\psscor2.dll
0:000&gt; !help
-------------------------------------------------------------------------------
PSSCOR is a debugger extension DLL designed to aid in the debugging of managed
programs. Functions are listed by category, then roughly in order of
importance. Shortcut names for popular functions are listed in parenthesis.
Type &quot;!help &quot; for detailed info on that function.

Object Inspection                  Examining code and stacks
-----------------------------      -----------------------------
DumpObj (do)                       Threads
DumpArray (da)                     CLRStack
DumpStackObjects (dso)             IP2MD
DumpAllExceptions (dae)            BPMD
DumpHeap                           U
DumpVC                             DumpStack
GCRoot                             EEStack
ObjSize                            GCInfo
FinalizeQueue                      EHInfo
PrintException (pe)                COMState
TraverseHeap
DumpField (df)
DumpDynamicAssemblies (dda)
GCRef
DumpColumnNames (dcn)
DumpRequestQueues
DumpUMService

Examining CLR data structures      Diagnostic Utilities
-----------------------------      -----------------------------
DumpDomain                         VerifyHeap
EEHeap                             DumpLog
Name2EE                            FindAppDomain
SyncBlk                            SaveModule
DumpThreadConfig (dtc)             SaveAllModules (sam)
DumpMT                             GCHandles
DumpClass                          GCHandleLeaks
DumpMD                             VMMap
Token2EE                           VMStat
EEVersion                          ProcInfo
DumpModule                         StopOnException (soe)
ThreadPool                         MinidumpMode
DumpHttpRuntime                    FindDebugTrue
DumpIL                             FindDebugModules
PrintDateTime                      Analysis
DumpDataTables                     CLRUsage
DumpAssembly                       CheckCurrentException (cce)
RCWCleanupList                     CurrentExceptionName (cen)
PrintIPAddress                     VerifyObj
DumpHttpContext                    HeapStat
ASPXPages                          GCWhere
DumpASPNETCache (dac)              ListNearObj (lno)
DumpSig
DumpMethodSig                      Other
DumpRuntimeTypes                   -----------------------------
ConvertVTDateToDate (cvtdd)        FAQ
ConvertTicksToDate (ctd)
DumpRequestTable
DumpHistoryTable
DumpBuckets
GetWorkItems
DumpXmlDocument (dxd)
DumpCollection (dc)

Examining the GC history
-----------------------------
HistInit
HistStats
HistRoot
HistObj
HistObjFind
HistClear
</code></pre><p><strong>mscordacwks.dll</strong></p><p>æˆ‘å–œæ¬¢åœ¨æœåŠ¡å™¨ä¸­åˆ›å»ºç¨‹åºçš„dumpæ–‡ä»¶ï¼Œç„¶åæŠŠdumpæ–‡ä»¶è½¬ç§»åˆ°è‡ªå·±çš„windows7å¼€å‘æœºä¸Šè¿›è¡Œè°ƒè¯•ã€‚å‡å¦‚æœåŠ¡å™¨æ˜¯Windows Server 2008 R2çš„æ“ä½œç³»ç»Ÿï¼Œå½“æˆ‘åœ¨æœ¬åœ°å¼€å‘æœºä½¿ç”¨psscor2æ—¶ï¼Œå¾ˆå®¹æ˜“é‡åˆ°ä¸‹é¢çš„é”™è¯¯ï¼š</p><pre><code>CLRDLL: CLR DLL load disabled
Failed to load data access DLL, 0x80004005
Verify that 1) you have a recent build of the debugger (6.2.14 or newer)
            2) the file mscordacwks.dll that matches your version of mscorwks.dll is
                in the version directory
            3) or, if you are debugging a dump file, verify that the file
                mscordacwks___.dll is on your symbol path.
            4) you are debugging on the same architecture as the dump file.
                For example, an IA64 dump file must be debugged on an IA64
                machine.

You can also run the debugger command .cordll to control the debugger's
load of mscordacwks.dll.  .cordll -ve -u -l will do a verbose reload.
If that succeeds, the PSSCOR command should work on retry.

If you are debugging a minidump, you need to make sure that your executable
path is pointing to mscorwks.dll as well.
</code></pre><p>é€šè¿‡bingæœç´¢å‘ç°ä¸€ç¯‡ç›¸å…³çš„åšå®¢æ–‡ç« <a class=link href=http://blogs.msdn.com/b/dougste/archive/2009/02/18/failed-to-load-data-access-dll-0x80004005-or-what-is-mscordacwks-dll.aspx target=_blank rel=noopener>how to work around the mscordacwks issue</a>ï¼Œæ–‡ç« æŒ‡å‡ºéœ€è¦æŠŠæœåŠ¡å™¨çš„mscordacwksæ–‡ä»¶æ‹·è´åˆ°windbgç¨‹åºç›®å½•ä¸‹ã€‚mscordacwksåœ¨æˆ‘çš„Windows Server 2008 R2æœåŠ¡å™¨ä¸Šçš„ç‰ˆæœ¬æ˜¯4952ï¼Œæ‰€ä»¥æˆ‘æŠŠæœåŠ¡å™¨ä¸Šçš„mscordacwksæ‹·è´åˆ°windbgç›®å½•ï¼Œå¹¶é‡å‘½åä¸ºâ€œmscordacwks_AMD64_AMD64_2.0.50727.4952.dllâ€œã€‚mscordacwksåœ¨æœåŠ¡å™¨çš„è·¯å¾„æ˜¯â€œâ€C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscordacwks.dllâ€ï¼Œå‡å¦‚ä½ ä¸çŸ¥é“æ­£ç¡®çš„é‡å‘½åè§„åˆ™ï¼Œä½ å¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œè¾“å‡ºä¼šæç¤ºéœ€è¦åŠ è½½çš„mscordacwkså‘½åã€‚</p><pre><code>0:000&gt; .cordll -ve -u -l
CLR DLL status: No load attempts
0:000&gt; !threads
CLRDLL: C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscordacwks.dll:2.0.50727.3053 f:0
doesn't match desired version 2.0.50727.3625 f:0
CLRDLL: Unable to find mscordacwks_AMD64_AMD64_2.0.50727.4952.dll by mscorwks search
CLRDLL: Unable to find 'mscordacwks_AMD64_AMD64_2.0.50727.4952.dll' on the path
CLRDLL: Unable to get version info for 'd:\debug\symbols\mscorwks.dll\4E154C985a9000\mscordacwks_AMD64_AMD64_2.0.50727.4952.dll', Win32 error 0n87
CLRDLL: ERROR: Unable to load DLL mscordacwks_AMD64_AMD64_2.0.50727.4952.dll, Win32 error 0n87
Failed to load data access DLL, 0x80004005
Verify that 1) you have a recent build of the debugger (6.2.14 or newer)
            2) the file mscordacwks.dll that matches your version of mscorwks.dll is
                in the version directory
            3) or, if you are debugging a dump file, verify that the file
                mscordacwks___.dll is on your symbol path.
            4) you are debugging on the same architecture as the dump file.
                For example, an IA64 dump file must be debugged on an IA64
                machine.

You can also run the debugger command .cordll to control the debugger's
load of mscordacwks.dll.  .cordll -ve -u -l will do a verbose reload.
If that succeeds, the PSSCOR command should work on retry.

If you are debugging a minidump, you need to make sure that your executable
path is pointing to mscorwks.dll as well.
</code></pre><p>é‡å‘½ååï¼Œå†æ¬¡è¾“å…¥ä¸Šé¢çš„å‘½ä»¤ï¼Œä¼šæ˜¾ç¤ºåŠ è½½æˆåŠŸæç¤ºã€‚</p><pre><code>0:000&gt; .cordll -ve -u -l
CLR DLL status: Loaded DLL mscordacwks_AMD64_AMD64_2.0.50727.4952.dll
</code></pre><p><strong>æ£€æŸ¥CRLå †æ ˆ</strong></p><p>è¦æŸ¥çœ‹CLRå †æ ˆå†…å®¹ï¼Œè¾“å…¥ä¸‹é¢å‘½ä»¤ï¼š</p><pre><code>!clrstack
</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code>0:000&gt; !clrstack
OS Thread Id: 0xa48 (0)
*** WARNING: Unable to verify checksum for mscorlib.ni.dll
Child-SP         RetAddr          Call Site
000000000012e910 000007fef5a910e9 DomainNeutralILStubClass.IL_STUB(Microsoft.Win32.SafeHandles.SafeFileHandle, Byte*, Int32, Int32 ByRef, IntPtr)
000000000012ea30 000007fef5a91202 System.IO.__ConsoleStream.ReadFileNative(Microsoft.Win32.SafeHandles.SafeFileHandle, Byte[], Int32, Int32, Int32, Int32 ByRef)
000000000012ea90 000007fef538065a System.IO.__ConsoleStream.Read(Byte[], Int32, Int32)
000000000012eaf0 000007fef53a28ca System.IO.StreamReader.ReadBuffer()
000000000012eb40 000007fef5a9435f System.IO.StreamReader.ReadLine()
000000000012eb90 000007ff0017015b System.IO.TextReader+SyncTextReader.ReadLine()
000000000012ebf0 000007fef791d502 Program.Main()
</code></pre><p>çœŸæ£’ï¼ä½ ç°åœ¨å¯ä»¥çœ‹åˆ°å †æ ˆçš„è°ƒç”¨æƒ…å†µäº†ã€‚æˆ‘ä»¬å¯ä»¥ç«‹å³çœ‹åˆ°ç¨‹åºè¿›å…¥äº†Program.Mainå‡½æ•°ï¼Œè°ƒç”¨Console.ReadLineå¹¶ç­‰å¾…ç”¨æˆ·çš„è¾“å…¥ã€‚</p><p><strong>ç»“è®º</strong></p><p>æœ¬ç¯‡æ–‡ç« åªæ˜¯ç®€å•ä»‹ç»windbgçš„ä½¿ç”¨ï¼Œå‡å¦‚ä½ æƒ³å…¨å±€çš„äº†è§£windbgï¼Œå¹¶å¦‚ä½•ä½¿ç”¨windbgåšæ•…éšœæ’é™¤ï¼Œå¯ä»¥çœ‹ä¸‹Tess Ferrandezçš„è§†é¢‘æ•™ç¨‹â€œDebugging .NET Applications with WinDbgâ€œã€‚</p><p><strong>æ‰©å±•é˜…è¯»ï¼š</strong></p><p><a class=link href=http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx target=_blank rel=noopener>Process Explorer from SysInternals</a></p><p><a class=link href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=5c068e9f-ebfe-48a5-8b2f-0ad6ab454ad4" target=_blank rel=noopener>PssCor2 Debugging Extension</a></p><p><a class=link href=http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx target=_blank rel=noopener>Download the Debugging Tools for Windows</a></p><p><a class=link href=http://msdn.microsoft.com/en-us/library/bb190764.aspx target=_blank rel=noopener>SOS.dll (SOS Debugging Extension)</a></p><p><a class=link href=http://blogs.msdn.com/b/dougste/archive/2009/02/18/failed-to-load-data-access-dll-0x80004005-or-what-is-mscordacwks-dll.aspx target=_blank rel=noopener>â€œFailed to load data access DLL, 0x80004005â€ â€“ OR â€“ What is mscordacwks.dll?</a></p><p><a class=link href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=28bd5941-c458-46f1-b24d-f60151d875a3&displaylang=en" target=_blank rel=noopener>DebugDiag</a></p><p><a class=link href=http://blogs.msdn.com/b/johan/archive/2007/11/26/getting-started-with-windbg-part-ii.aspx target=_blank rel=noopener>Getting started with windbg - part I</a></p><p><a class=link href=http://blogs.msdn.com/b/johan/archive/2007/11/26/getting-started-with-windbg-part-ii.aspx target=_blank rel=noopener>Getting started with windbg - part II</a></p></section><footer class=article-footer><section class=article-tags><a href=//blog.tri-lib.com/tags/windbg>Win dbg</a></section></footer></article><aside class="widget related-contents--wrapper"></aside><footer class=site-footer><section class=copyright>&copy; 2020 cxfksword's notes</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank>Stack</a></b> designed by
<a href=https://jimmycai.com target=_blank>Jimmy</a></section></footer></main></div></div><div class=pswp tabindex=-1 role=dialog aria-hidden=true style=display:none><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=//blog.tri-lib.com/ts/main.js defer></script><script>(function(){const customFont=document.createElement('link');customFont.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";customFont.type="text/css";customFont.rel="stylesheet";document.head.appendChild(customFont);}());</script></body></html>